<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NexusBooth 2026 | AI Multi-Shot Photobooth</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Futuristic 2026 Color Palette */
            --bg-deep: #050510;
            --bg-space: #0a0b1a;
            --bg-holo: #11132a;
            --bg-card: #1a1d3a;
            --bg-surface: #24284d;
            
            /* Neon Cyberpunk Colors */
            --neon-pink: #ff00ff;
            --neon-cyan: #00ffff;
            --neon-green: #00ffaa;
            --neon-purple: #9d00ff;
            --neon-yellow: #ffff00;
            --neon-orange: #ff6b00;
            
            /* Gradients 2026 */
            --gradient-holo: linear-gradient(135deg, #ff00ff, #00ffff, #00ffaa);
            --gradient-cyber: linear-gradient(135deg, #9d00ff, #ff00ff, #00ffff);
            --gradient-neon: linear-gradient(135deg, #ff6b00, #ffff00, #00ffaa);
            --gradient-space: linear-gradient(135deg, #050510, #11132a, #24284d);
            
            /* Text Colors */
            --text-glowing: #ffffff;
            --text-primary: #e0e0ff;
            --text-secondary: #a0a3cc;
            --text-muted: #6b6d99;
            
            /* Special Effects */
            --glow-pink: 0 0 30px rgba(255, 0, 255, 0.6);
            --glow-cyan: 0 0 30px rgba(0, 255, 255, 0.6);
            --glow-green: 0 0 30px rgba(0, 255, 170, 0.6);
            --glow-purple: 0 0 30px rgba(157, 0, 255, 0.6);
            
            /* Typography 2026 */
            --font-heading: 'Space Grotesk', sans-serif;
            --font-body: 'Inter', sans-serif;
            
            /* Spacing System */
            --radius-sm: 10px;
            --radius-md: 16px;
            --radius-lg: 24px;
            --radius-xl: 32px;
            --radius-full: 50%;
            
            /* Shadows Futuristic */
            --shadow-holo: 0 10px 40px rgba(255, 0, 255, 0.3);
            --shadow-cyber: 0 10px 40px rgba(0, 255, 255, 0.3);
            --shadow-space: 0 20px 60px rgba(0, 0, 0, 0.6);
            --shadow-glow: 0 0 50px rgba(255, 255, 255, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            background: var(--bg-deep);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Animated Cyber Background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(255, 0, 255, 0.15) 0%, transparent 40%),
                radial-gradient(circle at 80% 20%, rgba(0, 255, 255, 0.15) 0%, transparent 40%),
                radial-gradient(circle at 40% 40%, rgba(0, 255, 170, 0.1) 0%, transparent 50%),
                linear-gradient(45deg, rgba(5, 5, 16, 0.9), rgba(17, 19, 42, 0.9));
            z-index: -2;
            animation: bgPulse 10s infinite alternate;
        }

        @keyframes bgPulse {
            0% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        /* Grid Lines Animation */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 200%;
            height: 200%;
            background-image: 
                linear-gradient(to right, rgba(255, 0, 255, 0.05) 1px, transparent 1px),
                linear-gradient(to bottom, rgba(0, 255, 255, 0.05) 1px, transparent 1px);
            background-size: 50px 50px;
            animation: gridMove 20s linear infinite;
            z-index: -1;
            opacity: 0.3;
        }

        @keyframes gridMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(-50px, -50px); }
        }

        /* Main Container */
        .app-container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 20px;
            display: grid;
            grid-template-columns: 1fr 420px;
            gap: 24px;
            min-height: 100vh;
        }

        /* Header - Futuristic */
        .header {
            grid-column: 1 / -1;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            margin-bottom: 24px;
            position: relative;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 16px;
            position: relative;
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            background: var(--gradient-holo);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            animation: logoGlow 3s infinite alternate;
            box-shadow: var(--shadow-holo);
        }

        @keyframes logoGlow {
            0% { box-shadow: var(--glow-pink); }
            33% { box-shadow: var(--glow-cyan); }
            66% { box-shadow: var(--glow-green); }
            100% { box-shadow: var(--glow-purple); }
        }

        .logo-text {
            font-family: var(--font-heading);
            font-size: 2rem;
            font-weight: 700;
            background: var(--gradient-holo);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            letter-spacing: 1px;
            text-shadow: 0 0 20px rgba(255, 0, 255, 0.5);
        }

        .version-badge {
            background: var(--gradient-cyber);
            color: white;
            padding: 4px 12px;
            border-radius: var(--radius-full);
            font-size: 0.8rem;
            font-weight: 600;
            margin-top: 4px;
        }

        /* Camera Status Panel */
        .status-panel {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .multi-shot-indicator {
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(255, 255, 255, 0.05);
            padding: 12px 24px;
            border-radius: var(--radius-full);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .shot-dots {
            display: flex;
            gap: 8px;
        }

        .shot-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .shot-dot.active {
            background: var(--neon-pink);
            box-shadow: 0 0 10px var(--neon-pink);
            animation: dotPulse 1s infinite;
        }

        .shot-dot.captured {
            background: var(--neon-green);
            box-shadow: 0 0 10px var(--neon-green);
        }

        @keyframes dotPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        .shot-counter {
            font-family: var(--font-heading);
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--text-glowing);
        }

        /* Main Camera Area */
        .camera-section {
            background: var(--bg-space);
            border-radius: var(--radius-xl);
            overflow: hidden;
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: var(--shadow-space);
        }

        .camera-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-holo);
            opacity: 0.05;
            z-index: 1;
        }

        .camera-container {
            position: relative;
            width: 100%;
            height: 600px;
            overflow: hidden;
            background: #000;
            z-index: 2;
        }

        #videoElement {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transform: scaleX(-1);
            display: block;
        }

        /* Live Filter Preview Canvas */
        .live-filter-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 3;
            display: none;
        }

        .filter-active .live-filter-canvas {
            display: block;
        }

        /* Camera Overlay Effects */
        .camera-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 4;
        }

        /* Grid Lines 2026 */
        .holo-grid {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(to right, rgba(255, 0, 255, 0.1) 1px, transparent 1px),
                linear-gradient(to bottom, rgba(0, 255, 255, 0.1) 1px, transparent 1px);
            background-size: 50px 50px;
            opacity: 0.3;
        }

        /* Focus Ring Animation */
        .focus-ring {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 140px;
            height: 140px;
            border: 2px solid var(--neon-cyan);
            border-radius: var(--radius-full);
            animation: ringSpin 4s linear infinite;
            box-shadow: var(--glow-cyan);
        }

        @keyframes ringSpin {
            0% { transform: translate(-50%, -50%) rotate(0deg) scale(1); }
            50% { transform: translate(-50%, -50%) rotate(180deg) scale(1.1); }
            100% { transform: translate(-50%, -50%) rotate(360deg) scale(1); }
        }

        /* Multi-Shot Controls */
        .multi-shot-controls {
            padding: 24px;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 24px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .shot-mode-selector {
            display: flex;
            gap: 12px;
            background: rgba(255, 255, 255, 0.05);
            padding: 8px;
            border-radius: var(--radius-lg);
        }

        .mode-btn {
            padding: 12px 24px;
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-md);
            color: var(--text-secondary);
            font-family: var(--font-heading);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .mode-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.6s;
        }

        .mode-btn:hover::before {
            left: 100%;
        }

        .mode-btn:hover {
            color: var(--text-glowing);
            border-color: var(--neon-pink);
        }

        .mode-btn.active {
            background: var(--gradient-holo);
            color: white;
            border-color: transparent;
            box-shadow: var(--shadow-holo);
        }

        .mode-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--neon-yellow);
            color: black;
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: var(--radius-full);
            font-weight: 800;
        }

        /* Capture Button - Futuristic */
        .capture-container {
            display: flex;
            align-items: center;
            gap: 30px;
        }

        .capture-btn {
            width: 80px;
            height: 80px;
            border-radius: var(--radius-full);
            background: var(--gradient-holo);
            border: none;
            cursor: pointer;
            position: relative;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-holo);
            animation: buttonGlow 3s infinite alternate;
        }

        @keyframes buttonGlow {
            0% { box-shadow: 0 0 30px rgba(255, 0, 255, 0.6); }
            50% { box-shadow: 0 0 40px rgba(0, 255, 255, 0.6); }
            100% { box-shadow: 0 0 30px rgba(0, 255, 170, 0.6); }
        }

        .capture-btn:hover {
            transform: scale(1.1);
        }

        .capture-btn:active {
            transform: scale(0.95);
        }

        .capture-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 60px;
            height: 60px;
            background: white;
            border-radius: var(--radius-full);
            box-shadow: inset 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .capture-count {
            font-family: var(--font-heading);
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--neon-cyan);
            text-shadow: 0 0 10px var(--neon-cyan);
        }

        /* Gallery Preview - 2026 Style */
        .gallery-preview {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-top: 20px;
            width: 100%;
            max-width: 400px;
        }

        .gallery-item {
            width: 100%;
            aspect-ratio: 1;
            border-radius: var(--radius-md);
            overflow: hidden;
            position: relative;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .gallery-item.active {
            border-color: var(--neon-pink);
            box-shadow: var(--glow-pink);
            transform: translateY(-5px);
        }

        .gallery-empty {
            background: rgba(255, 255, 255, 0.05);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            font-size: 2rem;
        }

        /* Sidebar - TikTok Style Filters */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .filter-panel {
            background: var(--bg-holo);
            border-radius: var(--radius-xl);
            padding: 24px;
            box-shadow: var(--shadow-space);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .panel-title {
            font-family: var(--font-heading);
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text-glowing);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .panel-title i {
            font-size: 1.6rem;
        }

        .filter-count {
            background: var(--gradient-cyber);
            color: white;
            padding: 6px 14px;
            border-radius: var(--radius-full);
            font-size: 0.9rem;
            font-weight: 600;
        }

        /* Filter Categories TikTok Style */
        .filter-categories {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding-bottom: 10px;
        }

        .filter-categories::-webkit-scrollbar {
            height: 4px;
        }

        .filter-categories::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
        }

        .filter-categories::-webkit-scrollbar-thumb {
            background: var(--neon-pink);
            border-radius: 2px;
        }

        .category-btn {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-full);
            color: var(--text-secondary);
            white-space: nowrap;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .category-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
        }

        .category-btn.active {
            background: var(--gradient-holo);
            color: white;
            border-color: transparent;
            box-shadow: var(--shadow-holo);
        }

        /* TikTok Effects Grid */
        .effects-scroll {
            max-height: 380px;
            overflow-y: auto;
            padding-right: 8px;
        }

        .effects-scroll::-webkit-scrollbar {
            width: 6px;
        }

        .effects-scroll::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }

        .effects-scroll::-webkit-scrollbar-thumb {
            background: var(--neon-pink);
            border-radius: 3px;
        }

        .effects-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 14px;
            margin-bottom: 20px;
        }

        .filter-card {
            background: var(--bg-card);
            border: 2px solid transparent;
            border-radius: var(--radius-lg);
            padding: 18px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .filter-card:hover {
            transform: translateY(-5px);
            border-color: var(--neon-pink);
            box-shadow: var(--shadow-holo);
        }

        .filter-card.active {
            background: linear-gradient(135deg, rgba(255, 0, 255, 0.15), rgba(0, 255, 255, 0.15));
            border-color: var(--neon-pink);
            box-shadow: var(--glow-pink);
        }

        .filter-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.6s;
        }

        .filter-card:hover::before {
            left: 100%;
        }

        .filter-icon {
            width: 48px;
            height: 48px;
            background: var(--gradient-space);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 12px;
            position: relative;
            overflow: hidden;
        }

        .filter-card.active .filter-icon {
            background: var(--gradient-holo);
        }

        .filter-name {
            font-family: var(--font-heading);
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-glowing);
            margin-bottom: 6px;
        }

        .filter-trending {
            font-size: 0.75rem;
            color: var(--neon-yellow);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 4px;
        }

        .filter-desc {
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        /* Live Preview Badge */
        .live-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--neon-green);
            color: black;
            font-size: 0.7rem;
            padding: 3px 8px;
            border-radius: var(--radius-full);
            font-weight: 800;
            animation: badgeFlash 1s infinite;
        }

        @keyframes badgeFlash {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Intensity Slider - Futuristic */
        .intensity-slider {
            margin-top: 24px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .slider-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .slider-label {
            font-family: var(--font-heading);
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-glowing);
        }

        .slider-value {
            font-size: 1.1rem;
            color: var(--neon-cyan);
            font-weight: 700;
            text-shadow: 0 0 10px var(--neon-cyan);
        }

        .slider-container {
            position: relative;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .slider-track {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 50%;
            background: var(--gradient-holo);
            border-radius: 4px;
        }

        .slider-handle {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 20px var(--neon-pink);
        }

        /* Multi-Shot Preview Panel */
        .multi-shot-panel {
            background: var(--bg-holo);
            border-radius: var(--radius-xl);
            padding: 24px;
            box-shadow: var(--shadow-space);
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: none;
        }

        .multi-shot-panel.active {
            display: block;
            animation: panelSlide 0.5s ease;
        }

        @keyframes panelSlide {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .multi-shot-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .multi-shot-item {
            aspect-ratio: 1;
            border-radius: var(--radius-lg);
            overflow: hidden;
            position: relative;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .multi-shot-item canvas {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .shot-number {
            position: absolute;
            top: 10px;
            left: 10px;
            background: var(--neon-pink);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.9rem;
            box-shadow: var(--glow-pink);
        }

        .panel-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .action-btn {
            padding: 16px;
            border-radius: var(--radius-lg);
            border: none;
            font-family: var(--font-heading);
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
        }

        .action-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s;
        }

        .action-btn:hover::before {
            left: 100%;
        }

        .action-btn.download-all {
            background: var(--gradient-holo);
            color: white;
        }

        .action-btn.retake-all {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-holo);
        }

        /* Footer 2026 */
        .footer {
            grid-column: 1 / -1;
            text-align: center;
            padding: 30px 0 0;
            margin-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .tech-tags {
            display: flex;
            justify-content: center;
            gap: 16px;
            margin-top: 16px;
            flex-wrap: wrap;
        }

        .tech-tag {
            background: rgba(255, 255, 255, 0.05);
            padding: 6px 16px;
            border-radius: var(--radius-full);
            font-size: 0.8rem;
            color: var(--neon-cyan);
            border: 1px solid rgba(0, 255, 255, 0.2);
        }

        /* Flash Effect */
        .flash-effect {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            z-index: 9999;
            pointer-events: none;
            opacity: 0;
            display: none;
        }

        .flash-effect.active {
            display: block;
            animation: flash 0.4s ease;
        }

        @keyframes flash {
            0% { opacity: 0; }
            50% { opacity: 0.8; }
            100% { opacity: 0; }
        }

        /* Responsive Design */
        @media (max-width: 1400px) {
            .app-container {
                grid-template-columns: 1fr;
            }
            
            .camera-container {
                height: 500px;
            }
            
            .sidebar {
                order: 3;
            }
        }

        @media (max-width: 768px) {
            .app-container {
                padding: 16px;
            }
            
            .camera-container {
                height: 400px;
            }
            
            .header {
                flex-direction: column;
                gap: 20px;
                align-items: flex-start;
            }
            
            .effects-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .multi-shot-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .camera-container {
                height: 350px;
            }
            
            .effects-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .panel-actions {
                grid-template-columns: 1fr;
            }
            
            .filter-categories {
                flex-wrap: wrap;
            }
        }

        /* Loading Animation */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-deep);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            gap: 24px;
        }

        .hologram-loader {
            width: 80px;
            height: 80px;
            position: relative;
        }

        .hologram-loader::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-holo);
            border-radius: 50%;
            animation: hologramSpin 2s linear infinite;
        }

        @keyframes hologramSpin {
            0% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.2); }
            100% { transform: rotate(360deg) scale(1); }
        }

        .loading-text {
            font-family: var(--font-heading);
            font-size: 1.2rem;
            color: var(--neon-cyan);
            text-shadow: 0 0 10px var(--neon-cyan);
            animation: textPulse 2s infinite;
        }

        @keyframes textPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body>
    <!-- Flash Effect -->
    <div class="flash-effect" id="flashEffect"></div>
    
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="hologram-loader"></div>
        <div class="loading-text">INITIALIZING NEXUSBOOTH 2026</div>
    </div>
    
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="logo-container">
                <div class="logo-icon">
                    <i>‚ú®</i>
                </div>
                <div>
                    <div class="logo-text">NEXUSBOOTH</div>
                    <div class="version-badge">2026 EDITION</div>
                </div>
            </div>
            
            <div class="status-panel">
                <div class="multi-shot-indicator">
                    <div class="shot-dots" id="shotDots">
                        <div class="shot-dot" data-shot="1"></div>
                        <div class="shot-dot" data-shot="2"></div>
                        <div class="shot-dot" data-shot="3"></div>
                        <div class="shot-dot" data-shot="4"></div>
                    </div>
                    <div class="shot-counter" id="shotCounter">SHOT 1/4</div>
                </div>
            </div>
        </header>
        
        <!-- Main Camera Section -->
        <main class="camera-section">
            <div class="camera-container">
                <video id="videoElement" autoplay playsinline></video>
                <canvas class="live-filter-canvas" id="liveFilterCanvas"></canvas>
                
                <div class="camera-overlay">
                    <div class="holo-grid"></div>
                    <div class="focus-ring"></div>
                </div>
            </div>
            
            <div class="multi-shot-controls">
                <div class="shot-mode-selector">
                    <button class="mode-btn active" data-mode="1">
                        SINGLE
                        <span class="mode-badge">1</span>
                    </button>
                    <button class="mode-btn" data-mode="2">
                        DUO
                        <span class="mode-badge">2</span>
                    </button>
                    <button class="mode-btn" data-mode="3">
                        TRIO
                        <span class="mode-badge">3</span>
                    </button>
                    <button class="mode-btn" data-mode="4">
                        QUAD
                        <span class="mode-badge">4</span>
                    </button>
                </div>
                
                <div class="capture-container">
                    <div class="capture-count" id="captureCount">01</div>
                    <button class="capture-btn" id="captureBtn"></button>
                    <div class="capture-count" id="maxShots">/04</div>
                </div>
                
                <div class="gallery-preview" id="galleryPreview">
                    <div class="gallery-item gallery-empty">+</div>
                    <div class="gallery-item gallery-empty">+</div>
                    <div class="gallery-item gallery-empty">+</div>
                    <div class="gallery-item gallery-empty">+</div>
                </div>
            </div>
        </main>
        
        <!-- Sidebar -->
        <aside class="sidebar">
            <!-- Filters Panel -->
            <div class="filter-panel">
                <div class="panel-header">
                    <h3 class="panel-title">
                        <i>üé≠</i> TIKTOK FILTERS 2026
                    </h3>
                    <span class="filter-count" id="filterCount">24 TRENDING</span>
                </div>
                
                <div class="filter-categories" id="filterCategories">
                    <!-- Categories will be loaded here -->
                </div>
                
                <div class="effects-scroll">
                    <div class="effects-grid" id="effectsGrid">
                        <!-- Effects will be loaded here -->
                    </div>
                </div>
                
                <div class="intensity-slider">
                    <div class="slider-header">
                        <span class="slider-label">FILTER POWER</span>
                        <span class="slider-value" id="intensityValue">100%</span>
                    </div>
                    <div class="slider-container" id="sliderContainer">
                        <div class="slider-track" id="sliderTrack"></div>
                        <div class="slider-handle" id="sliderHandle"></div>
                    </div>
                </div>
            </div>
            
            <!-- Multi-Shot Preview Panel -->
            <div class="multi-shot-panel" id="multiShotPanel">
                <div class="panel-header">
                    <h3 class="panel-title">
                        <i>üéûÔ∏è</i> 4-SHOT COLLAGE
                    </h3>
                    <span class="filter-count" id="collageCount">4 SHOTS</span>
                </div>
                
                <div class="multi-shot-grid" id="multiShotGrid">
                    <!-- Multi-shot items will be added here -->
                </div>
                
                <div class="panel-actions">
                    <button class="action-btn download-all" id="downloadCollageBtn">
                        <i>üì•</i> DOWNLOAD ALL
                    </button>
                    <button class="action-btn retake-all" id="retakeAllBtn">
                        <i>üîÑ</i> RETAKES
                    </button>
                </div>
            </div>
        </aside>
        
        <!-- Footer -->
        <footer class="footer">
            <p>¬© 2026 <span style="color: var(--neon-pink); font-weight: 700;">NEXUSBOOTH</span> ‚Äî NEXT-GEN PHOTOBOOTH EXPERIENCE</p>
            <div class="tech-tags">
                <span class="tech-tag">AI-POWERED</span>
                <span class="tech-tag">MULTI-SHOT</span>
                <span class="tech-tag">REAL-TIME FILTERS</span>
                <span class="tech-tag">4K READY</span>
                <span class="tech-tag">METAVERSE COMPATIBLE</span>
            </div>
        </footer>
    </div>

    <script>
        // DOM Elements
        const videoElement = document.getElementById('videoElement');
        const liveFilterCanvas = document.getElementById('liveFilterCanvas');
        const liveFilterCtx = liveFilterCanvas.getContext('2d');
        const captureBtn = document.getElementById('captureBtn');
        const flashEffect = document.getElementById('flashEffect');
        const loadingOverlay = document.getElementById('loadingOverlay');
        const effectsGrid = document.getElementById('effectsGrid');
        const filterCategories = document.getElementById('filterCategories');
        const intensityValue = document.getElementById('intensityValue');
        const sliderContainer = document.getElementById('sliderContainer');
        const sliderTrack = document.getElementById('sliderTrack');
        const sliderHandle = document.getElementById('sliderHandle');
        const shotDots = document.getElementById('shotDots');
        const shotCounter = document.getElementById('shotCounter');
        const captureCount = document.getElementById('captureCount');
        const maxShots = document.getElementById('maxShots');
        const galleryPreview = document.getElementById('galleryPreview');
        const multiShotPanel = document.getElementById('multiShotPanel');
        const multiShotGrid = document.getElementById('multiShotGrid');
        const downloadCollageBtn = document.getElementById('downloadCollageBtn');
        const retakeAllBtn = document.getElementById('retakeAllBtn');
        const filterCount = document.getElementById('filterCount');
        const collageCount = document.getElementById('collageCount');
        
        // State Variables
        let currentStream = null;
        let activeFilter = null;
        let filterIntensity = 100;
        let shotsTaken = 0;
        let maxShotsCount = 4;
        let currentMode = 1;
        let shotsArray = new Array(maxShotsCount).fill(null);
        let isLiveFilterActive = false;
        let animationFrameId = null;
        
        // TikTok 2026 Filters Database
        const tiktokFilters = [
            // VIRAL EFFECTS
            {
                id: 'alien',
                name: 'Alien Vision',
                description: 'Glitchy green overlay',
                icon: 'üëΩ',
                category: 'viral',
                trending: true,
                apply: applyAlienEffect
            },
            {
                id: 'rainbow',
                name: 'Rainbow Vibe',
                description: 'Colorful spectrum waves',
                icon: 'üåà',
                category: 'viral',
                trending: true,
                apply: applyRainbowEffect
            },
            {
                id: 'glitch',
                name: 'Cyber Glitch',
                description: 'Digital distortion effect',
                icon: 'üì±',
                category: 'viral',
                trending: true,
                apply: applyGlitchEffect
            },
            {
                id: 'sparkle',
                name: 'Sparkle Queen',
                description: 'Magical sparkles overlay',
                icon: '‚ú®',
                category: 'viral',
                apply: applySparkleEffect
            },
            
            // BEAUTY FILTERS
            {
                id: 'glass',
                name: 'Glass Skin',
                description: 'Korean glass skin effect',
                icon: 'üíé',
                category: 'beauty',
                trending: true,
                apply: applyGlassSkinEffect
            },
            {
                id: 'doll',
                name: 'Anime Doll',
                description: 'Big eyes & smooth skin',
                icon: 'üéÄ',
                category: 'beauty',
                apply: applyDollEffect
            },
            {
                id: 'blush',
                name: 'Blush Filter',
                description: 'Cute pink blush overlay',
                icon: 'üçë',
                category: 'beauty',
                apply: applyBlushEffect
            },
            {
                id: 'sunset',
                name: 'Golden Hour',
                description: 'Warm sunset glow',
                icon: 'üåÖ',
                category: 'beauty',
                apply: applyGoldenHourEffect
            },
            
            // FUNNY EFFECTS
            {
                id: 'anime',
                name: 'Anime Filter',
                description: 'Turn into anime character',
                icon: 'üëÅÔ∏è',
                category: 'funny',
                trending: true,
                apply: applyAnimeEffect
            },
            {
                id: 'cat',
                name: 'Cat Face',
                description: 'Cute cat ears & nose',
                icon: 'üê±',
                category: 'funny',
                trending: true,
                apply: applyCatEffect
            },
            {
                id: 'clown',
                name: 'Funny Clown',
                description: 'Red nose & rainbow hair',
                icon: 'ü§°',
                category: 'funny',
                trending: true,
                apply: applyClownEffect
            },
            {
                id: 'swap',
                name: 'Face Swap',
                description: 'Swap faces with others',
                icon: 'üîÑ',
                category: 'funny',
                apply: applyFaceSwapEffect
            },
            
            // AR EFFECTS
            {
                id: 'crown',
                name: 'Crown AR',
                description: 'Floating golden crown',
                icon: 'üëë',
                category: 'ar',
                apply: applyCrownEffect
            },
            {
                id: 'halo',
                name: 'Angel Halo',
                description: 'Floating angel halo',
                icon: 'üòá',
                category: 'ar',
                apply: applyHaloEffect
            },
            {
                id: 'glasses',
                name: 'AR Glasses',
                description: 'Virtual reality glasses',
                icon: 'üëì',
                category: 'ar',
                trending: true,
                apply: applyARGlassesEffect
            },
            {
                id: 'hearts',
                name: 'Floating Hearts',
                description: 'Floating heart particles',
                icon: 'üíñ',
                category: 'ar',
                apply: applyHeartsEffect
            },
            
            // SPECIAL EFFECTS
            {
                id: 'neon',
                name: 'Neon Outline',
                description: 'Glowing neon edges',
                icon: 'üîÆ',
                category: 'special',
                trending: true,
                apply: applyNeonEffect
            },
            {
                id: 'vaporwave',
                name: 'Vaporwave',
                description: 'Retro aesthetic',
                icon: 'üå¥',
                category: 'special',
                trending: true,
                apply: applyVaporwaveEffect
            },
            {
                id: 'disco',
                name: 'Disco Ball',
                description: 'Disco lights effect',
                icon: 'ü™©',
                category: 'special',
                apply: applyDiscoEffect
            },
            {
                id: 'synth',
                name: 'Synthwave',
                description: '80s retro synth',
                icon: 'üéõÔ∏è',
                category: 'special',
                trending: true,
                apply: applySynthwaveEffect
            },
            
            // FACE MODIFICATION
            {
                id: 'bigeyes',
                name: 'Big Eyes',
                description: 'Make eyes bigger',
                icon: 'üëÄ',
                category: 'face',
                apply: applyBigEyesEffect
            },
            {
                id: 'slim',
                name: 'Face Slim',
                description: 'Slim face filter',
                icon: '‚ö°',
                category: 'face',
                apply: applySlimFaceEffect
            },
            {
                id: 'beard',
                name: 'Virtual Beard',
                description: 'Add beard & mustache',
                icon: 'üßî',
                category: 'face',
                apply: applyBeardEffect
            },
            {
                id: 'makeup',
                name: 'AR Makeup',
                description: 'Virtual makeup',
                icon: 'üíÑ',
                category: 'face',
                trending: true,
                apply: applyMakeupEffect
            }
        ];

        // Categories
        const categories = [
            { id: 'all', name: 'All Filters', icon: 'üåü' },
            { id: 'viral', name: 'Viral', icon: 'üî•' },
            { id: 'beauty', name: 'Beauty', icon: 'üíÖ' },
            { id: 'funny', name: 'Funny', icon: 'üòÇ' },
            { id: 'ar', name: 'AR', icon: 'üëÅÔ∏è' },
            { id: 'special', name: 'Special', icon: 'üéØ' },
            { id: 'face', name: 'Face', icon: 'üë§' }
        ];

        // Initialize App
        async function initApp() {
            showLoading('Initializing AI Camera...');
            
            try {
                // Initialize camera
                await initCamera();
                
                // Setup UI
                createCategoryButtons();
                createFilterCards();
                initSlider();
                initModeButtons();
                updateShotDisplay();
                
                // Start live filter preview
                startLivePreview();
                
                // Hide loading
                setTimeout(() => {
                    hideLoading();
                }, 1000);
                
            } catch (error) {
                showError('Failed to initialize camera');
                console.error('Initialization error:', error);
            }
        }

        // Initialize Camera
        async function initCamera() {
            const constraints = {
                video: {
                    width: { ideal: 1280 },
                    height: { ideal: 720 },
                    facingMode: 'user',
                    frameRate: { ideal: 60 }
                },
                audio: false
            };
            
            currentStream = await navigator.mediaDevices.getUserMedia(constraints);
            videoElement.srcObject = currentStream;
            
            // Set canvas size to match video
            videoElement.onloadedmetadata = () => {
                liveFilterCanvas.width = videoElement.videoWidth;
                liveFilterCanvas.height = videoElement.videoHeight;
            };
        }

        // Start Live Preview
        function startLivePreview() {
            function renderLivePreview() {
                if (videoElement.readyState === videoElement.HAVE_ENOUGH_DATA) {
                    // Update canvas size if needed
                    if (liveFilterCanvas.width !== videoElement.videoWidth ||
                        liveFilterCanvas.height !== videoElement.videoHeight) {
                        liveFilterCanvas.width = videoElement.videoWidth;
                        liveFilterCanvas.height = videoElement.videoHeight;
                    }
                    
                    // Clear canvas
                    liveFilterCtx.clearRect(0, 0, liveFilterCanvas.width, liveFilterCanvas.height);
                    
                    // Draw video frame (mirrored)
                    liveFilterCtx.save();
                    liveFilterCtx.translate(liveFilterCanvas.width, 0);
                    liveFilterCtx.scale(-1, 1);
                    liveFilterCtx.drawImage(videoElement, 0, 0, liveFilterCanvas.width, liveFilterCanvas.height);
                    liveFilterCtx.restore();
                    
                    // Apply active filter
                    if (activeFilter && isLiveFilterActive) {
                        const filter = tiktokFilters.find(f => f.id === activeFilter);
                        if (filter && filter.apply) {
                            filter.apply(liveFilterCtx, liveFilterCanvas.width, liveFilterCanvas.height, filterIntensity / 100);
                        }
                    }
                }
                
                animationFrameId = requestAnimationFrame(renderLivePreview);
            }
            
            renderLivePreview();
        }

        // Create Category Buttons
        function createCategoryButtons() {
            categories.forEach(category => {
                const button = document.createElement('button');
                button.className = 'category-btn';
                button.dataset.category = category.id;
                button.innerHTML = `${category.icon} ${category.name}`;
                
                if (category.id === 'all') {
                    button.classList.add('active');
                }
                
                button.addEventListener('click', () => {
                    // Update active category
                    document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    
                    // Filter effects
                    filterEffectsByCategory(category.id);
                });
                
                filterCategories.appendChild(button);
            });
        }

        // Create Filter Cards
        function createFilterCards() {
            effectsGrid.innerHTML = '';
            
            tiktokFilters.forEach(filter => {
                const card = document.createElement('div');
                card.className = 'filter-card';
                card.dataset.filterId = filter.id;
                card.dataset.category = filter.category;
                
                card.innerHTML = `
                    <div class="filter-icon">${filter.icon}</div>
                    ${filter.trending ? '<div class="filter-trending">TRENDING</div>' : ''}
                    <div class="filter-name">${filter.name}</div>
                    <div class="filter-desc">${filter.description}</div>
                    ${filter.trending ? '<div class="live-badge">LIVE</div>' : ''}
                `;
                
                card.addEventListener('click', () => {
                    // Remove active from all filters
                    document.querySelectorAll('.filter-card').forEach(card => card.classList.remove('active'));
                    
                    // Toggle active filter
                    if (activeFilter === filter.id) {
                        activeFilter = null;
                        isLiveFilterActive = false;
                        document.querySelector('.camera-section').classList.remove('filter-active');
                    } else {
                        card.classList.add('active');
                        activeFilter = filter.id;
                        isLiveFilterActive = true;
                        document.querySelector('.camera-section').classList.add('filter-active');
                    }
                    
                    // Update count
                    updateFilterCount();
                });
                
                effectsGrid.appendChild(card);
            });
            
            updateFilterCount();
        }

        // Filter Effects by Category
        function filterEffectsByCategory(categoryId) {
            const allCards = document.querySelectorAll('.filter-card');
            
            allCards.forEach(card => {
                if (categoryId === 'all' || card.dataset.category === categoryId) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // Update Filter Count
        function updateFilterCount() {
            const trendingCount = tiktokFilters.filter(f => f.trending).length;
            filterCount.textContent = `${tiktokFilters.length} FILTERS ‚Ä¢ ${trendingCount} TRENDING`;
        }

        // Initialize Intensity Slider
        function initSlider() {
            let isDragging = false;
            
            sliderHandle.addEventListener('mousedown', startDrag);
            sliderHandle.addEventListener('touchstart', startDrag);
            
            document.addEventListener('mousemove', drag);
            document.addEventListener('touchmove', drag);
            document.addEventListener('mouseup', stopDrag);
            document.addEventListener('touchend', stopDrag);
            
            function startDrag(e) {
                isDragging = true;
                e.preventDefault();
            }
            
            function drag(e) {
                if (!isDragging) return;
                
                const containerRect = sliderContainer.getBoundingClientRect();
                let x;
                
                if (e.type.includes('touch')) {
                    x = e.touches[0].clientX - containerRect.left;
                } else {
                    x = e.clientX - containerRect.left;
                }
                
                // Clamp value between 0 and container width
                x = Math.max(0, Math.min(x, containerRect.width));
                
                // Calculate percentage
                const percentage = (x / containerRect.width) * 100;
                
                // Update slider
                updateSlider(percentage);
            }
            
            function stopDrag() {
                isDragging = false;
            }
            
            // Click on track to set value
            sliderContainer.addEventListener('click', (e) => {
                const containerRect = sliderContainer.getBoundingClientRect();
                const x = e.clientX - containerRect.left;
                const percentage = (x / containerRect.width) * 100;
                updateSlider(percentage);
            });
        }

        // Update Slider
        function updateSlider(percentage) {
            filterIntensity = Math.round(percentage);
            intensityValue.textContent = `${filterIntensity}%`;
            sliderTrack.style.width = `${percentage}%`;
            sliderHandle.style.left = `${percentage}%`;
        }

        // Initialize Mode Buttons
        function initModeButtons() {
            const modeButtons = document.querySelectorAll('.mode-btn');
            
            modeButtons.forEach(button => {
                button.addEventListener('click', () => {
                    // Remove active from all buttons
                    modeButtons.forEach(btn => btn.classList.remove('active'));
                    
                    // Set active
                    button.classList.add('active');
                    
                    // Update mode
                    currentMode = parseInt(button.dataset.mode);
                    maxShotsCount = currentMode;
                    maxShots.textContent = `/${currentMode.toString().padStart(2, '0')}`;
                    
                    // Reset shots if mode changes
                    if (shotsTaken > currentMode) {
                        resetShots();
                    }
                    
                    updateShotDisplay();
                });
            });
        }

        // Update Shot Display
        function updateShotDisplay() {
            // Update shot counter
            captureCount.textContent = (shotsTaken + 1).toString().padStart(2, '0');
            shotCounter.textContent = `SHOT ${shotsTaken + 1}/${maxShotsCount}`;
            
            // Update dots
            const dots = document.querySelectorAll('.shot-dot');
            dots.forEach((dot, index) => {
                dot.classList.remove('active', 'captured');
                
                if (index < maxShotsCount) {
                    dot.style.display = 'block';
                    
                    if (index === shotsTaken) {
                        dot.classList.add('active');
                    } else if (index < shotsTaken) {
                        dot.classList.add('captured');
                    }
                } else {
                    dot.style.display = 'none';
                }
            });
            
            // Update gallery preview
            updateGalleryPreview();
        }

        // Update Gallery Preview
        function updateGalleryPreview() {
            const galleryItems = galleryPreview.querySelectorAll('.gallery-item');
            
            galleryItems.forEach((item, index) => {
                if (index < maxShotsCount) {
                    item.style.display = 'block';
                    
                    if (shotsArray[index]) {
                        item.classList.remove('gallery-empty');
                        item.innerHTML = `<img src="${shotsArray[index]}" alt="Shot ${index + 1}">`;
                        
                        if (index === shotsTaken - 1) {
                            item.classList.add('active');
                        } else {
                            item.classList.remove('active');
                        }
                    } else {
                        item.classList.add('gallery-empty');
                        item.classList.remove('active');
                        item.innerHTML = '+';
                    }
                } else {
                    item.style.display = 'none';
                }
            });
        }

        // Capture Photo
        captureBtn.addEventListener('click', () => {
            if (!currentStream) {
                showError('Camera not ready');
                return;
            }
            
            // Flash effect
            triggerFlash();
            
            // Create canvas for capture
            const tempCanvas = document.createElement('canvas');
            const tempCtx = tempCanvas.getContext('2d');
            
            // Set dimensions
            tempCanvas.width = videoElement.videoWidth;
            tempCanvas.height = videoElement.videoHeight;
            
            // Draw video frame (mirrored)
            tempCtx.save();
            tempCtx.translate(tempCanvas.width, 0);
            tempCtx.scale(-1, 1);
            tempCtx.drawImage(videoElement, 0, 0, tempCanvas.width, tempCanvas.height);
            tempCtx.restore();
            
            // Apply active filter
            if (activeFilter) {
                const filter = tiktokFilters.find(f => f.id === activeFilter);
                if (filter && filter.apply) {
                    filter.apply(tempCtx, tempCanvas.width, tempCanvas.height, filterIntensity / 100);
                }
            }
            
            // Store shot
            const imageData = tempCanvas.toDataURL('image/jpeg');
            shotsArray[shotsTaken] = imageData;
            shotsTaken++;
            
            // Update display
            updateShotDisplay();
            
            // If all shots taken, show collage
            if (shotsTaken >= maxShotsCount) {
                showMultiShotCollage();
            }
            
            // Play capture sound
            playCaptureSound();
        });

        // Trigger Flash
        function triggerFlash() {
            flashEffect.classList.add('active');
            setTimeout(() => {
                flashEffect.classList.remove('active');
            }, 400);
        }

        // Show Multi-Shot Collage
        function showMultiShotCollage() {
            // Clear previous collage
            multiShotGrid.innerHTML = '';
            
            // Create collage items
            shotsArray.slice(0, maxShotsCount).forEach((shot, index) => {
                if (shot) {
                    const item = document.createElement('div');
                    item.className = 'multi-shot-item';
                    
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    
                    // Load image and draw to canvas
                    const img = new Image();
                    img.onload = () => {
                        canvas.width = 400;
                        canvas.height = 400;
                        ctx.drawImage(img, 0, 0, 400, 400);
                        
                        // Add number badge
                        const number = document.createElement('div');
                        number.className = 'shot-number';
                        number.textContent = index + 1;
                        item.appendChild(number);
                        
                        item.appendChild(canvas);
                    };
                    img.src = shot;
                    
                    multiShotGrid.appendChild(item);
                }
            });
            
            // Show panel
            multiShotPanel.classList.add('active');
            collageCount.textContent = `${maxShotsCount} SHOTS`;
        }

        // Download Collage
        downloadCollageBtn.addEventListener('click', () => {
            // Create a collage canvas
            const collageCanvas = document.createElement('canvas');
            const collageCtx = collageCanvas.getContext('2d');
            
            // Set dimensions based on mode
            let collageWidth, collageHeight;
            switch(maxShotsCount) {
                case 1:
                    collageWidth = 2000;
                    collageHeight = 2000;
                    break;
                case 2:
                    collageWidth = 2000;
                    collageHeight = 1000;
                    break;
                case 3:
                case 4:
                    collageWidth = 2000;
                    collageHeight = 2000;
                    break;
            }
            
            collageCanvas.width = collageWidth;
            collageCanvas.height = collageHeight;
            
            // Create images array
            const images = shotsArray.slice(0, maxShotsCount).filter(shot => shot);
            
            // Load all images and create collage
            Promise.all(images.map(src => 
                new Promise((resolve) => {
                    const img = new Image();
                    img.onload = () => resolve(img);
                    img.src = src;
                })
            )).then(loadedImages => {
                // Draw collage based on mode
                switch(maxShotsCount) {
                    case 1:
                        collageCtx.drawImage(loadedImages[0], 0, 0, collageWidth, collageHeight);
                        break;
                    case 2:
                        collageCtx.drawImage(loadedImages[0], 0, 0, collageWidth/2, collageHeight);
                        collageCtx.drawImage(loadedImages[1], collageWidth/2, 0, collageWidth/2, collageHeight);
                        break;
                    case 3:
                        collageCtx.drawImage(loadedImages[0], 0, 0, collageWidth/2, collageHeight/2);
                        collageCtx.drawImage(loadedImages[1], collageWidth/2, 0, collageWidth/2, collageHeight/2);
                        collageCtx.drawImage(loadedImages[2], 0, collageHeight/2, collageWidth, collageHeight/2);
                        break;
                    case 4:
                        collageCtx.drawImage(loadedImages[0], 0, 0, collageWidth/2, collageHeight/2);
                        collageCtx.drawImage(loadedImages[1], collageWidth/2, 0, collageWidth/2, collageHeight/2);
                        collageCtx.drawImage(loadedImages[2], 0, collageHeight/2, collageWidth/2, collageHeight/2);
                        collageCtx.drawImage(loadedImages[3], collageWidth/2, collageHeight/2, collageWidth/2, collageHeight/2);
                        break;
                }
                
                // Add watermark
                collageCtx.font = 'bold 40px Space Grotesk';
                collageCtx.fillStyle = 'rgba(255, 255, 255, 0.7)';
                collageCtx.textAlign = 'right';
                collageCtx.fillText('NEXUSBOOTH 2026', collageWidth - 30, collageHeight - 30);
                
                // Create download link
                const link = document.createElement('a');
                link.download = `nexusbooth_collage_${Date.now()}.jpg`;
                link.href = collageCanvas.toDataURL('image/jpeg', 0.95);
                link.click();
                
                // Show feedback
                const originalText = downloadCollageBtn.innerHTML;
                downloadCollageBtn.innerHTML = '<i>‚úÖ</i> COLLAGE SAVED!';
                downloadCollageBtn.style.opacity = '0.8';
                
                setTimeout(() => {
                    downloadCollageBtn.innerHTML = originalText;
                    downloadCollageBtn.style.opacity = '1';
                }, 2000);
            });
        });

        // Retake All Photos
        retakeAllBtn.addEventListener('click', () => {
            resetShots();
            multiShotPanel.classList.remove('active');
        });

        // Reset All Shots
        function resetShots() {
            shotsTaken = 0;
            shotsArray = new Array(4).fill(null);
            updateShotDisplay();
        }

        // Play Capture Sound
        function playCaptureSound() {
            // Create a simple beep sound
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                oscillator.frequency.setValueAtTime(600, audioContext.currentTime + 0.1);
                
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.2);
            } catch (e) {
                console.log('Audio not supported');
            }
        }

        // Show Loading
        function showLoading(message) {
            if (loadingOverlay) {
                loadingOverlay.style.display = 'flex';
                loadingOverlay.querySelector('.loading-text').textContent = message;
            }
        }

        // Hide Loading
        function hideLoading() {
            if (loadingOverlay) {
                loadingOverlay.style.display = 'none';
            }
        }

        // Show Error
        function showError(message) {
            shotCounter.textContent = message;
            shotCounter.style.color = 'var(--neon-pink)';
        }

        // TikTok 2026 Filter Effects
        function applyAlienEffect(ctx, width, height, intensity) {
            // Green alien overlay with glitch effect
            ctx.fillStyle = `rgba(0, 255, 100, ${0.3 * intensity})`;
            ctx.globalCompositeOperation = 'overlay';
            ctx.fillRect(0, 0, width, height);
            
            // Add glitch effect
            const imageData = ctx.getImageData(0, 0, width, height);
            const data = imageData.data;
            
            for (let i = 0; i < data.length; i += 4) {
                // Boost green channel
                data[i + 1] = Math.min(255, data[i + 1] * (1 + 0.5 * intensity));
            }
            
            ctx.putImageData(imageData, 0, 0);
            ctx.globalCompositeOperation = 'source-over';
            
            // Add scan lines
            ctx.strokeStyle = `rgba(0, 255, 100, ${0.1 * intensity})`;
            for (let y = 0; y < height; y += 4) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(width, y);
                ctx.stroke();
            }
        }

        function applyRainbowEffect(ctx, width, height, intensity) {
            // Create rainbow gradient overlay
            const time = Date.now() / 1000;
            const hue = (time * 60) % 360;
            
            const gradient = ctx.createLinearGradient(0, 0, width, 0);
            for (let i = 0; i < 6; i++) {
                gradient.addColorStop(i/6, `hsla(${(hue + i * 60) % 360}, 100%, 50%, ${0.2 * intensity})`);
            }
            
            ctx.fillStyle = gradient;
            ctx.globalCompositeOperation = 'overlay';
            ctx.fillRect(0, 0, width, height);
            ctx.globalCompositeOperation = 'source-over';
            
            // Add rainbow particles
            for (let i = 0; i < 20 * intensity; i++) {
                const x = Math.random() * width;
                const y = Math.random() * height;
                const size = 2 + Math.random() * 8;
                const color = `hsl(${Math.random() * 360}, 100%, 70%)`;
                
                ctx.fillStyle = color;
                ctx.beginPath();
                ctx.arc(x, y, size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function applyGlitchEffect(ctx, width, height, intensity) {
            // Create glitch displacement
            const glitchAmount = 10 * intensity;
            const glitchHeight = height * 0.1;
            
            for (let i = 0; i < 3; i++) {
                const y = Math.random() * height;
                const displacement = (Math.random() - 0.5) * glitchAmount * 2;
                
                // Copy and shift a slice
                const slice = ctx.getImageData(0, y, width, glitchHeight);
                ctx.putImageData(slice, displacement, y);
            }
            
            // Add RGB split
            const imageData = ctx.getImageData(0, 0, width, height);
            const data = imageData.data;
            
            for (let i = 0; i < data.length; i += 4) {
                // RGB shift
                const shift = Math.random() * 10 * intensity;
                data[i] = Math.min(255, data[i] + shift); // Red shift
                data[i + 2] = Math.max(0, data[i + 2] - shift); // Blue shift
            }
            
            ctx.putImageData(imageData, 0, 0);
        }

        function applySparkleEffect(ctx, width, height, intensity) {
            // Add sparkle particles
            const time = Date.now() / 1000;
            
            for (let i = 0; i < 30 * intensity; i++) {
                const x = (width * 0.3) + Math.sin(time + i) * width * 0.4;
                const y = (time * 100 + i * 50) % height;
                const size = 3 + Math.sin(time * 2 + i) * 5;
                
                // Create sparkle
                ctx.fillStyle = `rgba(255, 255, 255, ${0.8 * intensity})`;
                ctx.save();
                ctx.translate(x, y);
                
                // Draw star shape
                for (let j = 0; j < 5; j++) {
                    ctx.rotate(Math.PI * 2 / 5);
                    ctx.fillRect(-size/2, -size/20, size, size/10);
                }
                
                ctx.restore();
            }
        }

        function applyGlassSkinEffect(ctx, width, height, intensity) {
            // Apply skin smoothing and glow
            const imageData = ctx.getImageData(0, 0, width, height);
            const data = imageData.data;
            
            // Simple blur effect for skin smoothing
            for (let i = 4; i < data.length; i += 4) {
                // Average with previous pixel (simple blur)
                data[i] = (data[i] + data[i - 4]) / 2;
                data[i + 1] = (data[i + 1] + data[i - 3]) / 2;
                data[i + 2] = (data[i + 2] + data[i - 2]) / 2;
            }
            
            ctx.putImageData(imageData, 0, 0);
            
            // Add glow overlay
            const gradient = ctx.createRadialGradient(
                width / 2, height / 3, 0,
                width / 2, height / 3, Math.max(width, height) / 2
            );
            gradient.addColorStop(0, `rgba(255, 255, 255, ${0.3 * intensity})`);
            gradient.addColorStop(1, 'rgba(255, 255, 255, 0)');
            
            ctx.fillStyle = gradient;
            ctx.globalCompositeOperation = 'overlay';
            ctx.fillRect(0, 0, width, height);
            ctx.globalCompositeOperation = 'source-over';
        }

        function applyDollEffect(ctx, width, height, intensity) {
            // Apply anime doll effect (simplified)
            const imageData = ctx.getImageData(0, 0, width, height);
            const data = imageData.data;
            
            for (let i = 0; i < data.length; i += 4) {
                // Increase brightness and reduce saturation
                const avg = (data[i] + data[i + 1] + data[i + 2]) / 3;
                data[i] = avg * 0.3 + data[i] * 0.7;
                data[i + 1] = avg * 0.3 + data[i + 1] * 0.7;
                data[i + 2] = avg * 0.3 + data[i + 2] * 0.7;
                
                // Brighten
                data[i] = Math.min(255, data[i] + 40 * intensity);
                data[i + 1] = Math.min(255, data[i + 1] + 40 * intensity);
                data[i + 2] = Math.min(255, data[i + 2] + 40 * intensity);
            }
            
            ctx.putImageData(imageData, 0, 0);
            
            // Draw anime-style blush
            ctx.fillStyle = `rgba(255, 200, 200, ${0.4 * intensity})`;
            ctx.beginPath();
            ctx.arc(width * 0.3, height * 0.6, 30 * intensity, 0, Math.PI * 2);
            ctx.arc(width * 0.7, height * 0.6, 30 * intensity, 0, Math.PI * 2);
            ctx.fill();
        }

        function applyBlushEffect(ctx, width, height, intensity) {
            // Add cute blush circles
            ctx.fillStyle = `rgba(255, 150, 150, ${0.5 * intensity})`;
            ctx.beginPath();
            ctx.arc(width * 0.35, height * 0.6, 40 * intensity, 0, Math.PI * 2);
            ctx.arc(width * 0.65, height * 0.6, 40 * intensity, 0, Math.PI * 2);
            ctx.fill();
            
            // Add sparkle to blush
            ctx.fillStyle = `rgba(255, 255, 255, ${0.8 * intensity})`;
            ctx.beginPath();
            ctx.arc(width * 0.4, height * 0.55, 5 * intensity, 0, Math.PI * 2);
            ctx.arc(width * 0.6, height * 0.55, 5 * intensity, 0, Math.PI * 2);
            ctx.fill();
        }

        function applyGoldenHourEffect(ctx, width, height, intensity) {
            // Add warm golden overlay
            const gradient = ctx.createLinearGradient(0, 0, width, height);
            gradient.addColorStop(0, `rgba(255, 200, 50, ${0.3 * intensity})`);
            gradient.addColorStop(1, `rgba(255, 100, 0, ${0.2 * intensity})`);
            
            ctx.fillStyle = gradient;
            ctx.globalCompositeOperation = 'overlay';
            ctx.fillRect(0, 0, width, height);
            ctx.globalCompositeOperation = 'source-over';
        }

        function applyAnimeEffect(ctx, width, height, intensity) {
            // Apply anime-style color grading
            const imageData = ctx.getImageData(0, 0, width, height);
            const data = imageData.data;
            
            for (let i = 0; i < data.length; i += 4) {
                // Boost saturation and contrast
                const max = Math.max(data[i], data[i + 1], data[i + 2]);
                data[i] = Math.min(255, data[i] * 1.2);
                data[i + 1] = Math.min(255, data[i + 1] * 1.1);
                data[i + 2] = Math.min(255, data[i + 2] * 1.3);
                
                // Increase contrast
                data[i] = ((data[i] - 128) * 1.2) + 128;
                data[i + 1] = ((data[i + 1] - 128) * 1.2) + 128;
                data[i + 2] = ((data[i + 2] - 128) * 1.2) + 128;
            }
            
            ctx.putImageData(imageData, 0, 0);
            
            // Add anime shine to eyes (simulated)
            ctx.fillStyle = `rgba(255, 255, 255, ${0.8 * intensity})`;
            ctx.beginPath();
            ctx.arc(width * 0.4, height * 0.45, 8 * intensity, 0, Math.PI * 2);
            ctx.arc(width * 0.6, height * 0.45, 8 * intensity, 0, Math.PI * 2);
            ctx.fill();
        }

        function applyCatEffect(ctx, width, height, intensity) {
            // Draw cat ears
            ctx.fillStyle = `rgba(255, 182, 193, ${intensity})`;
            
            // Left ear
            ctx.beginPath();
            ctx.moveTo(width * 0.4, height * 0.2);
            ctx.lineTo(width * 0.35, height * 0.1);
            ctx.lineTo(width * 0.45, height * 0.15);
            ctx.closePath();
            ctx.fill();
            
            // Right ear
            ctx.beginPath();
            ctx.moveTo(width * 0.6, height * 0.2);
            ctx.lineTo(width * 0.65, height * 0.1);
            ctx.lineTo(width * 0.55, height * 0.15);
            ctx.closePath();
            ctx.fill();
            
            // Draw cat nose
            ctx.fillStyle = 'pink';
            ctx.beginPath();
            ctx.arc(width * 0.5, height * 0.45, 10 * intensity, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw whiskers
            ctx.strokeStyle = 'white';
            ctx.lineWidth = 2 * intensity;
            
            for (let i = 0; i < 3; i++) {
                // Left whiskers
                ctx.beginPath();
                ctx.moveTo(width * 0.4, height * 0.45);
                ctx.lineTo(width * 0.3 - i * 8, height * 0.4 + i * 8);
                ctx.stroke();
                
                // Right whiskers
                ctx.beginPath();
                ctx.moveTo(width * 0.6, height * 0.45);
                ctx.lineTo(width * 0.7 + i * 8, height * 0.4 + i * 8);
                ctx.stroke();
            }
        }

        function applyClownEffect(ctx, width, height, intensity) {
            // Draw red clown nose
            ctx.fillStyle = '#FF0000';
            ctx.beginPath();
            ctx.arc(width * 0.5, height * 0.4, 30 * intensity, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw clown hair (rainbow)
            const colors = ['#FF0000', '#FF9900', '#FFFF00', '#00FF00', '#0000FF', '#9900FF'];
            for (let i = 0; i < 6; i++) {
                ctx.fillStyle = colors[i];
                ctx.beginPath();
                ctx.arc(
                    width * 0.5 + Math.cos(i * Math.PI / 3) * 50,
                    height * 0.15 + Math.sin(i * Math.PI / 3) * 30,
                    25 * intensity,
                    0,
                    Math.PI * 2
                );
                ctx.fill();
            }
        }

        // Note: Face swap would require advanced face detection
        function applyFaceSwapEffect(ctx, width, height, intensity) {
            // Simplified version - just a fun effect
            const imageData = ctx.getImageData(0, 0, width, height);
            const data = imageData.data;
            
            // Create a mirror effect for "swap"
            for (let i = 0; i < data.length / 2; i += 4) {
                const mirrorIndex = data.length - i - 4;
                
                // Swap RGB values
                const tempR = data[i];
                const tempG = data[i + 1];
                const tempB = data[i + 2];
                
                data[i] = data[mirrorIndex];
                data[i + 1] = data[mirrorIndex + 1];
                data[i + 2] = data[mirrorIndex + 2];
                
                data[mirrorIndex] = tempR;
                data[mirrorIndex + 1] = tempG;
                data[mirrorIndex + 2] = tempB;
            }
            
            ctx.putImageData(imageData, 0, 0);
        }

        // Note: AR effects would require face tracking
        function applyCrownEffect(ctx, width, height, intensity) {
            // Draw a simple crown at top
            ctx.fillStyle = `rgba(255, 215, 0, ${intensity})`;
            ctx.save();
            ctx.translate(width * 0.5, height * 0.2);
            
            // Crown base
            ctx.fillRect(-40, 0, 80, 15);
            
            // Crown points
            for (let i = 0; i < 5; i++) {
                ctx.beginPath();
                ctx.moveTo(-30 + i * 20, 0);
                ctx.lineTo(-20 + i * 20, -20);
                ctx.lineTo(-10 + i * 20, 0);
                ctx.closePath();
                ctx.fill();
            }
            
            ctx.restore();
            
            // Add sparkle
            ctx.fillStyle = `rgba(255, 255, 255, ${0.8 * intensity})`;
            ctx.beginPath();
            ctx.arc(width * 0.5, height * 0.15, 5 * intensity, 0, Math.PI * 2);
            ctx.fill();
        }

        // Initialize when page loads
        window.addEventListener('DOMContentLoaded', initApp);
        
        // Cleanup
        window.addEventListener('beforeunload', () => {
            if (currentStream) {
                currentStream.getTracks().forEach(track => track.stop());
            }
            if (animationFrameId) {
                cancelAnimationFrame(animationFrameId);
            }
        });
    </script>
</body>
</html>
