<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GlowPlus | AI Photobooth</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            color: #333;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 40px;
            background: white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 24px;
            font-weight: 700;
            color: #ff6b8b;
        }
        
        .logo i {
            font-size: 28px;
        }
        
        .header-actions {
            display: flex;
            gap: 20px;
            align-items: center;
        }
        
        .btn-premium {
            background: linear-gradient(135deg, #ff6b8b, #ff8e53);
            color: white;
            border: none;
            padding: 10px 24px;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 15px rgba(255, 107, 139, 0.3);
        }
        
        .btn-premium:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 139, 0.4);
        }
        
        /* Main Container */
        .main-container {
            display: flex;
            padding-top: 100px;
            min-height: 100vh;
        }
        
        /* Left Panel - Filters */
        .left-panel {
            width: 100px;
            background: white;
            padding: 30px 15px;
            box-shadow: 4px 0 12px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 100;
        }
        
        .filter-category {
            text-align: center;
            margin-bottom: 30px;
            width: 100%;
        }
        
        .filter-category h4 {
            font-size: 12px;
            color: #888;
            margin-bottom: 10px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .filter-icon {
            width: 60px;
            height: 60px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8f9fa;
            color: #666;
            font-size: 22px;
        }
        
        .filter-icon.active {
            background: linear-gradient(135deg, #6a11cb, #2575fc);
            color: white;
            transform: scale(1.05);
            box-shadow: 0 6px 15px rgba(106, 17, 203, 0.3);
        }
        
        .filter-icon:hover:not(.active) {
            background: #eef2ff;
            transform: translateY(-3px);
        }
        
        /* Camera Area */
        .camera-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 30px;
            position: relative;
        }
        
        .camera-preview-container {
            width: 100%;
            max-width: 800px;
            height: 600px;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            position: relative;
            background: #000;
            margin-bottom: 30px;
        }
        
        #camera-preview {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }
        
        .camera-overlay {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            display: flex;
            justify-content: space-between;
            z-index: 10;
        }
        
        .camera-controls {
            display: flex;
            gap: 15px;
        }
        
        .control-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: #555;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .control-btn:hover {
            background: white;
            transform: scale(1.1);
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.15);
        }
        
        .control-btn.active {
            background: #6a11cb;
            color: white;
        }
        
        .timer-display {
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 8px 20px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 18px;
            display: none;
        }
        
        /* Capture Button */
        .capture-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin-top: 20px;
        }
        
        .capture-btn {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: white;
            border: 5px solid #ff6b8b;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(255, 107, 139, 0.4);
            transition: all 0.3s ease;
            position: relative;
        }
        
        .capture-btn:before {
            content: '';
            position: absolute;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #ff6b8b;
        }
        
        .capture-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 15px 40px rgba(255, 107, 139, 0.5);
        }
        
        .capture-btn:active {
            transform: scale(0.95);
        }
        
        /* Filter Bar (Bottom) */
        .filter-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 20px;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.08);
            z-index: 1000;
        }
        
        .filter-bar h3 {
            margin-bottom: 15px;
            font-size: 16px;
            color: #555;
            padding-left: 120px;
        }
        
        .filters-container {
            display: flex;
            gap: 15px;
            padding-left: 120px;
            overflow-x: auto;
            padding-bottom: 10px;
        }
        
        .filter-item {
            flex-shrink: 0;
            width: 100px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .filter-preview {
            width: 100px;
            height: 130px;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        
        .filter-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .filter-preview:after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 12px;
            transition: all 0.3s ease;
        }
        
        .filter-item.active .filter-preview:after {
            border: 3px solid #6a11cb;
            box-shadow: inset 0 0 0 2px white;
        }
        
        .filter-item.active .filter-preview {
            transform: translateY(-5px);
        }
        
        .filter-name {
            text-align: center;
            font-size: 13px;
            color: #666;
            font-weight: 500;
        }
        
        .filter-item.active .filter-name {
            color: #6a11cb;
            font-weight: 600;
        }
        
        /* Right Panel - Editing Tools */
        .right-panel {
            width: 300px;
            background: white;
            padding: 30px 20px;
            box-shadow: -4px 0 12px rgba(0, 0, 0, 0.05);
            overflow-y: auto;
        }
        
        .tool-section {
            margin-bottom: 30px;
        }
        
        .tool-section h3 {
            font-size: 16px;
            margin-bottom: 15px;
            color: #444;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .tool-section h3 span {
            font-size: 12px;
            color: #888;
            font-weight: 400;
        }
        
        .slider-container {
            margin-bottom: 20px;
        }
        
        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
            color: #666;
        }
        
        .slider {
            width: 100%;
            height: 6px;
            -webkit-appearance: none;
            background: #eaeaea;
            border-radius: 3px;
            outline: none;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #6a11cb;
            cursor: pointer;
            box-shadow: 0 3px 8px rgba(106, 17, 203, 0.3);
        }
        
        .effect-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }
        
        .effect-item {
            text-align: center;
            cursor: pointer;
            padding: 10px 5px;
            border-radius: 10px;
            transition: all 0.3s ease;
        }
        
        .effect-item:hover {
            background: #f8f9fa;
        }
        
        .effect-item.active {
            background: #f0f4ff;
            color: #6a11cb;
        }
        
        .effect-icon {
            font-size: 24px;
            margin-bottom: 8px;
            display: block;
        }
        
        .effect-name {
            font-size: 12px;
            font-weight: 500;
        }
        
        /* Gallery Modal */
        .gallery-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 40px;
        }
        
        .gallery-content {
            background: white;
            border-radius: 20px;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .gallery-header {
            padding: 20px 30px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .gallery-header h2 {
            font-size: 22px;
            color: #333;
        }
        
        .close-gallery {
            background: none;
            border: none;
            font-size: 24px;
            color: #888;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .close-gallery:hover {
            background: #f8f8f8;
            color: #333;
        }
        
        .gallery-grid {
            padding: 30px;
            flex: 1;
            overflow-y: auto;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 20px;
        }
        
        .gallery-item {
            border-radius: 12px;
            overflow: hidden;
            height: 150px;
            cursor: pointer;
            position: relative;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .right-panel {
                display: none;
            }
            
            .filters-container, .filter-bar h3 {
                padding-left: 30px;
            }
        }
        
        @media (max-width: 768px) {
            .left-panel {
                display: none;
            }
            
            .camera-preview-container {
                height: 500px;
            }
            
            .filters-container, .filter-bar h3 {
                padding-left: 20px;
            }
            
            .header {
                padding: 15px 20px;
            }
            
            .logo span {
                display: none;
            }
            
            .btn-premium span {
                display: none;
            }
            
            .btn-premium {
                padding: 10px 15px;
            }
        }
        
        /* Loading */
        .loader {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: white;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        
        .spinner {
            width: 60px;
            height: 60px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #6a11cb;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Photo Canvas */
        .photo-canvas {
            display: none;
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loader" id="loader">
        <div class="spinner"></div>
    </div>
    
    <!-- Header -->
    <header class="header">
        <div class="logo">
            <i class="fas fa-camera-retro"></i>
            <span>GlowPlus</span>
        </div>
        <div class="header-actions">
            <button class="btn-premium" id="premium-btn">
                <i class="fas fa-crown"></i>
                <span>Go Premium</span>
            </button>
            <button class="control-btn" id="gallery-btn" title="Gallery">
                <i class="fas fa-images"></i>
            </button>
        </div>
    </header>
    
    <!-- Main Container -->
    <div class="main-container">
        <!-- Left Panel - Filter Categories -->
        <div class="left-panel">
            <div class="filter-category">
                <h4>Beauty</h4>
                <div class="filter-icon active" data-category="beauty">
                    <i class="fas fa-sparkles"></i>
                </div>
            </div>
            <div class="filter-category">
                <h4>Portrait</h4>
                <div class="filter-icon" data-category="portrait">
                    <i class="fas fa-user"></i>
                </div>
            </div>
            <div class="filter-category">
                <h4>Natural</h4>
                <div class="filter-icon" data-category="natural">
                    <i class="fas fa-leaf"></i>
                </div>
            </div>
            <div class="filter-category">
                <h4>Artistic</h4>
                <div class="filter-icon" data-category="artistic">
                    <i class="fas fa-palette"></i>
                </div>
            </div>
            <div class="filter-category">
                <h4>Vintage</h4>
                <div class="filter-icon" data-category="vintage">
                    <i class="fas fa-film"></i>
                </div>
            </div>
        </div>
        
        <!-- Camera Area -->
        <div class="camera-area">
            <div class="camera-preview-container">
                <video id="camera-preview" autoplay playsinline></video>
                <div class="camera-overlay">
                    <div class="camera-controls">
                        <button class="control-btn" id="flip-camera" title="Flip Camera">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                        <button class="control-btn" id="timer-btn" title="Timer (3s)">
                            <i class="fas fa-clock"></i>
                        </button>
                        <button class="control-btn" id="flash-btn" title="Flash">
                            <i class="fas fa-bolt"></i>
                        </button>
                        <button class="control-btn" id="grid-btn" title="Grid">
                            <i class="fas fa-th"></i>
                        </button>
                    </div>
                    <div class="timer-display" id="timer-display">3</div>
                </div>
            </div>
            
            <div class="capture-section">
                <button class="capture-btn" id="capture-btn"></button>
                <div style="display: flex; gap: 15px;">
                    <button class="control-btn" id="save-btn" title="Save Photo">
                        <i class="fas fa-download"></i>
                    </button>
                    <button class="control-btn" id="share-btn" title="Share">
                        <i class="fas fa-share-alt"></i>
                    </button>
                    <button class="control-btn" id="print-btn" title="Print">
                        <i class="fas fa-print"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Right Panel - Editing Tools -->
        <div class="right-panel">
            <div class="tool-section">
                <h3>Beauty Tools <span>PRO</span></h3>
                <div class="slider-container">
                    <div class="slider-label">
                        <span>Smooth Skin</span>
                        <span id="smooth-value">50%</span>
                    </div>
                    <input type="range" min="0" max="100" value="50" class="slider" id="smooth-slider">
                </div>
                <div class="slider-container">
                    <div class="slider-label">
                        <span>Brighten</span>
                        <span id="brighten-value">30%</span>
                    </div>
                    <input type="range" min="0" max="100" value="30" class="slider" id="brighten-slider">
                </div>
                <div class="slider-container">
                    <div class="slider-label">
                        <span>Face Slim</span>
                        <span id="slim-value">0%</span>
                    </div>
                    <input type="range" min="0" max="100" value="0" class="slider" id="slim-slider">
                </div>
            </div>
            
            <div class="tool-section">
                <h3>Effects</h3>
                <div class="effect-grid">
                    <div class="effect-item active" data-effect="none">
                        <span class="effect-icon">‚úñÔ∏è</span>
                        <span class="effect-name">None</span>
                    </div>
                    <div class="effect-item" data-effect="vignette">
                        <span class="effect-icon">‚≠ï</span>
                        <span class="effect-name">Vignette</span>
                    </div>
                    <div class="effect-item" data-effect="blur">
                        <span class="effect-icon">üåÄ</span>
                        <span class="effect-name">Blur</span>
                    </div>
                    <div class="effect-item" data-effect="grayscale">
                        <span class="effect-icon">‚ö´</span>
                        <span class="effect-name">B&W</span>
                    </div>
                    <div class="effect-item" data-effect="sepia">
                        <span class="effect-icon">üü§</span>
                        <span class="effect-name">Sepia</span>
                    </div>
                    <div class="effect-item" data-effect="noise">
                        <span class="effect-icon">üåü</span>
                        <span class="effect-name">Noise</span>
                    </div>
                </div>
            </div>
            
            <div class="tool-section">
                <h3>Makeup</h3>
                <div class="effect-grid">
                    <div class="effect-item" data-makeup="lipstick">
                        <span class="effect-icon">üíÑ</span>
                        <span class="effect-name">Lips</span>
                    </div>
                    <div class="effect-item" data-makeup="blush">
                        <span class="effect-icon">üçé</span>
                        <span class="effect-name">Blush</span>
                    </div>
                    <div class="effect-item" data-makeup="eyeliner">
                        <span class="effect-icon">üëÅÔ∏è</span>
                        <span class="effect-name">Eyes</span>
                    </div>
                    <div class="effect-item" data-makeup="foundation">
                        <span class="effect-icon">‚ú®</span>
                        <span class="effect-name">Base</span>
                    </div>
                    <div class="effect-item" data-makeup="eyeshadow">
                        <span class="effect-icon">üé®</span>
                        <span class="effect-name">Shadow</span>
                    </div>
                    <div class="effect-item" data-makeup="mascara">
                        <span class="effect-icon">üëÅÔ∏è‚Äçüó®Ô∏è</span>
                        <span class="effect-name">Lashes</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Filter Bar -->
    <div class="filter-bar">
        <h3>Popular Filters</h3>
        <div class="filters-container" id="filters-container">
            <!-- Filters will be generated dynamically -->
        </div>
    </div>
    
    <!-- Gallery Modal -->
    <div class="gallery-modal" id="gallery-modal">
        <div class="gallery-content">
            <div class="gallery-header">
                <h2>Your Photos</h2>
                <button class="close-gallery" id="close-gallery">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="gallery-grid" id="gallery-grid">
                <!-- Gallery items will appear here -->
            </div>
        </div>
    </div>
    
    <!-- Canvas for photo processing -->
    <canvas class="photo-canvas" id="photo-canvas"></canvas>
    
    <script>
        // Elements
        const video = document.getElementById('camera-preview');
        const canvas = document.getElementById('photo-canvas');
        const captureBtn = document.getElementById('capture-btn');
        const flipBtn = document.getElementById('flip-camera');
        const timerBtn = document.getElementById('timer-btn');
        const flashBtn = document.getElementById('flash-btn');
        const gridBtn = document.getElementById('grid-btn');
        const saveBtn = document.getElementById('save-btn');
        const shareBtn = document.getElementById('share-btn');
        const galleryBtn = document.getElementById('gallery-btn');
        const galleryModal = document.getElementById('gallery-modal');
        const closeGallery = document.getElementById('close-gallery');
        const filtersContainer = document.getElementById('filters-container');
        const galleryGrid = document.getElementById('gallery-grid');
        const loader = document.getElementById('loader');
        
        // Sliders
        const smoothSlider = document.getElementById('smooth-slider');
        const brightenSlider = document.getElementById('brighten-slider');
        const slimSlider = document.getElementById('slim-slider');
        const smoothValue = document.getElementById('smooth-value');
        const brightenValue = document.getElementById('brighten-value');
        const slimValue = document.getElementById('slim-value');
        
        // Variables
        let currentStream = null;
        let currentFacingMode = 'user';
        let timerActive = false;
        let timerCount = 3;
        let timerInterval = null;
        let flashActive = false;
        let gridActive = false;
        let currentFilter = 'none';
        let photos = [];
        
        // Sample filters (like BeautyPlus)
        const filters = [
            { name: "Natural", effect: "contrast(1.1) brightness(1.05) saturate(1.1)", preview: "https://images.unsplash.com/photo-1494790108755-2616b612b786?w=200&h=260&fit=crop&crop=face" },
            { name: "Portrait", effect: "contrast(1.2) brightness(1.1) saturate(1.2) blur(0.5px)", preview: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=200&h=260&fit=crop&crop=face" },
            { name: "Beauty", effect: "contrast(1.05) brightness(1.15) saturate(1.05) hue-rotate(5deg)", preview: "https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=200&h=260&fit=crop&crop=face" },
            { name: "Vintage", effect: "sepia(0.4) contrast(1.1) brightness(0.95) saturate(1.3)", preview: "https://images.unsplash.com/photo-1517841905240-472988babdf9?w=200&h=260&fit=crop&crop=face" },
            { name: "Warm", effect: "brightness(1.1) saturate(1.3) hue-rotate(-10deg)", preview: "https://images.unsplash.com/photo-1524504388940-b1c1722653e1?w=200&h=260&fit=crop&crop=face" },
            { name: "Cool", effect: "brightness(1.05) saturate(1.1) hue-rotate(180deg) contrast(1.1)", preview: "https://images.unsplash.com/photo-1488426862026-3ee34a7d66df?w=200&h=260&fit=crop&crop=face" },
            { name: "Dreamy", effect: "contrast(1.05) brightness(1.1) saturate(1.2) blur(1px)", preview: "https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=200&h=260&fit=crop&crop=face" },
            { name: "Crisp", effect: "contrast(1.3) brightness(1.05) saturate(1.1)", preview: "https://images.unsplash.com/photo-1499952127939-9bbf5af6c51c?w=200&h=260&fit=crop&crop=face" },
            { name: "Golden", effect: "sepia(0.2) contrast(1.1) brightness(1.1) saturate(1.4)", preview: "https://images.unsplash.com/photo-1504593811423-6dd665756598?w=200&h=260&fit=crop&crop=face" },
            { name: "Soft", effect: "contrast(1.05) brightness(1.08) saturate(1.05) blur(0.8px)", preview: "https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=200&h=260&fit=crop&crop=face" }
        ];
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Hide loader after 1.5 seconds
            setTimeout(() => {
                loader.style.opacity = '0';
                setTimeout(() => {
                    loader.style.display = 'none';
                }, 500);
            }, 1500);
            
            // Start camera automatically
            startCamera();
            
            // Generate filter thumbnails
            generateFilters();
            
            // Load sample gallery photos
            loadSampleGallery();
            
            // Set up slider events
            setupSliders();
            
            // Set up effect selection
            setupEffects();
            
            // Set up makeup selection
            setupMakeup();
        });
        
        // Start Camera
        async function startCamera() {
            try {
                const constraints = {
                    video: {
                        facingMode: currentFacingMode,
                        width: { ideal: 1280 },
                        height: { ideal: 720 }
                    },
                    audio: false
                };
                
                currentStream = await navigator.mediaDevices.getUserMedia(constraints);
                video.srcObject = currentStream;
            } catch (err) {
                console.error("Camera error:", err);
                alert("Cannot access camera. Please check permissions.");
            }
        }
        
        // Generate Filter Thumbnails
        function generateFilters() {
            filters.forEach((filter, index) => {
                const filterItem = document.createElement('div');
                filterItem.className = 'filter-item';
                if (index === 0) filterItem.classList.add('active');
                
                filterItem.innerHTML = `
                    <div class="filter-preview">
                        <img src="${filter.preview}" alt="${filter.name}">
                    </div>
                    <div class="filter-name">${filter.name}</div>
                `;
                
                filterItem.addEventListener('click', () => {
                    document.querySelectorAll('.filter-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    filterItem.classList.add('active');
                    currentFilter = filter.effect;
                    video.style.filter = currentFilter;
                });
                
                filtersContainer.appendChild(filterItem);
            });
        }
        
        // Setup Sliders
        function setupSliders() {
            smoothSlider.addEventListener('input', function() {
                smoothValue.textContent = this.value + '%';
                // In real app, apply smooth skin effect here
            });
            
            brightenSlider.addEventListener('input', function() {
                brightenValue.textContent = this.value + '%';
                // In real app, apply brighten effect here
            });
            
            slimSlider.addEventListener('input', function() {
                slimValue.textContent = this.value + '%';
                // In real app, apply face slimming effect here
            });
        }
        
        // Setup Effects
        function setupEffects() {
            document.querySelectorAll('.effect-item[data-effect]').forEach(item => {
                item.addEventListener('click', function() {
                    document.querySelectorAll('.effect-item[data-effect]').forEach(el => {
                        el.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // In real app, apply the selected effect
                    const effect = this.dataset.effect;
                    console.log("Effect selected:", effect);
                });
            });
        }
        
        // Setup Makeup
        function setupMakeup() {
            document.querySelectorAll('.effect-item[data-makeup]').forEach(item => {
                item.addEventListener('click', function() {
                    // Toggle active state for makeup items
                    if (this.classList.contains('active')) {
                        this.classList.remove('active');
                    } else {
                        this.classList.add('active');
                    }
                    
                    // In real app, apply/remove makeup effect
                    const makeup = this.dataset.makeup;
                    console.log("Makeup toggled:", makeup, this.classList.contains('active'));
                });
            });
        }
        
        // Load Sample Gallery
        function loadSampleGallery() {
            const samplePhotos = [
                'https://images.unsplash.com/photo-1494790108755-2616b612b786?w=400&h=400&fit=crop&crop=face',
                'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=400&h=400&fit=crop&crop=face',
                'https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=400&h=400&fit=crop&crop=face',
                'https://images.unsplash.com/photo-1517841905240-472988babdf9?w=400&h=400&fit=crop&crop=face',
                'https://images.unsplash.com/photo-1524504388940-b1c1722653e1?w=400&h=400&fit=crop&crop=face',
                'https://images.unsplash.com/photo-1488426862026-3ee34a7d66df?w=400&h=400&fit=crop&crop=face'
            ];
            
            samplePhotos.forEach(photo => {
                const galleryItem = document.createElement('div');
                galleryItem.className = 'gallery-item';
                galleryItem.innerHTML = `<img src="${photo}" alt="Gallery photo">`;
                galleryGrid.appendChild(galleryItem);
            });
        }
        
        // Capture Photo
        captureBtn.addEventListener('click', function() {
            if (timerActive) {
                startTimer();
                return;
            }
            
            capturePhoto();
        });
        
        // Timer Function
        function startTimer() {
            const timerDisplay = document.getElementById('timer-display');
            timerDisplay.style.display = 'block';
            timerDisplay.textContent = timerCount;
            
            let count = timerCount;
            timerInterval = setInterval(() => {
                count--;
                timerDisplay.textContent = count;
                
                if (count <= 0) {
                    clearInterval(timerInterval);
                    timerDisplay.style.display = 'none';
                    capturePhoto();
                }
            }, 1000);
        }
        
        // Capture Photo Function
        function capturePhoto() {
            if (!currentStream) {
                alert("Camera not started!");
                return;
            }
            
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            const context = canvas.getContext('2d');
            
            // Draw video frame to canvas
            context.drawImage(video, 0, 0, canvas.width, canvas.height);
            
            // Apply current filter
            context.filter = currentFilter;
            
            // Create photo data
            const photoData = canvas.toDataURL('image/png');
            
            // Add to photos array
            photos.push(photoData);
            
            // Add to gallery
            const galleryItem = document.createElement('div');
            galleryItem.className = 'gallery-item';
            galleryItem.innerHTML = `<img src="${photoData}" alt="Captured photo">`;
            galleryGrid.prepend(galleryItem);
            
            // Flash effect
            video.style.opacity = '0.7';
            setTimeout(() => {
                video.style.opacity = '1';
            }, 150);
            
            // Show success message
            const originalText = captureBtn.innerHTML;
            captureBtn.style.background = '#4CAF50';
            setTimeout(() => {
                captureBtn.style.background = '';
            }, 1000);
        }
        
        // Flip Camera
        flipBtn.addEventListener('click', async function() {
            if (currentStream) {
                currentStream.getTracks().forEach(track => track.stop());
            }
            
            currentFacingMode = currentFacingMode === 'user' ? 'environment' : 'user';
            await startCamera();
        });
        
        // Timer Toggle
        timerBtn.addEventListener('click', function() {
            timerActive = !timerActive;
            this.classList.toggle('active');
            
            if (timerActive) {
                timerCount = 3; // Reset to 3 seconds
                this.innerHTML = '<i class="fas fa-clock"></i>';
            }
        });
        
        // Flash Toggle
        flashBtn.addEventListener('click', function() {
            flashActive = !flashActive;
            this.classList.toggle('active');
            
            if (flashActive) {
                this.innerHTML = '<i class="fas fa-bolt" style="color: #FFD700;"></i>';
                // In real app, activate flash here
            } else {
                this.innerHTML = '<i class="fas fa-bolt"></i>';
            }
        });
        
        // Grid Toggle
        gridBtn.addEventListener('click', function() {
            gridActive = !gridActive;
            this.classList.toggle('active');
            
            // In real app, show/hide grid overlay on camera
            console.log("Grid toggled:", gridActive);
        });
        
        // Save Photo
        saveBtn.addEventListener('click', function() {
            if (photos.length === 0) {
                alert("No photos to save! Capture one first.");
                return;
            }
            
            const latestPhoto = photos[photos.length - 1];
            const link = document.createElement('a');
            link.download = `glowplus-photo-${Date.now()}.png`;
            link.href = latestPhoto;
            link.click();
            
            // Show feedback
            this.innerHTML = '<i class="fas fa-check"></i>';
            setTimeout(() => {
                this.innerHTML = '<i class="fas fa-download"></i>';
            }, 1500);
        });
        
        // Share Photo
        shareBtn.addEventListener('click', function() {
            if (photos.length === 0) {
                alert("No photos to share! Capture one first.");
                return;
            }
            
            if (navigator.share) {
                navigator.share({
                    title: 'My GlowPlus Photo',
                    text: 'Check out my photo from GlowPlus!',
                    url: photos[photos.length - 1]
                });
            } else {
                alert("Share feature is available on mobile devices. On desktop, you can download and share manually.");
            }
        });
        
        // Open Gallery
        galleryBtn.addEventListener('click', function() {
            galleryModal.style.display = 'flex';
        });
        
        // Close Gallery
        closeGallery.addEventListener('click', function() {
            galleryModal.style.display = 'none';
        });
        
        // Close gallery when clicking outside
        galleryModal.addEventListener('click', function(e) {
            if (e.target === galleryModal) {
                galleryModal.style.display = 'none';
            }
        });
        
        // Premium Button
        document.getElementById('premium-btn').addEventListener('click', function() {
            alert("‚ú® Premium Features:\n‚Ä¢ Unlimited filters\n‚Ä¢ HD photo saving\n‚Ä¢ Remove watermarks\n‚Ä¢ Advanced beauty tools\n‚Ä¢ Priority support");
        });
        
        // Filter Category Selection
        document.querySelectorAll('.filter-icon').forEach(icon => {
            icon.addEventListener('click', function() {
                document.querySelectorAll('.filter-icon').forEach(i => {
                    i.classList.remove('active');
                });
                this.classList.add('active');
                
                // In real app, load filters for this category
                const category = this.dataset.category;
                console.log("Filter category selected:", category);
            });
        });
    </script>
</body>
</html>
